$(document).ready(function(){log("here we go");loadData()});function loadData(){var a="https://spreadsheets.google.com/pub?hl=en&hl=en&key=0AkTjJmB1VuOXdG1sNTBiZkowczBXRWtSOXJuOFFsN3c&single=true&gid=0&output=txt";a="data/InfovisPeople.tsv";if(document.location.protocol=="http:"){a="proxy.php?link="+escape(a)}var b=function(g){log("data loaded");var d=g.split(/\r\n|\r|\n/);dataSet=[];headers=d.shift().split(/\t/);log("headers",headers);for(var f=0;f<d.length;f++){var c=d[f].split(/\t/);var h={};for(var e=0;e<c.length;e++){h[headers[e]]=c[e]}dataSet.push(h)}initVis()};$.get(a,b)}function initVis(){var c=window.document.width-30,i=window.document.height-100,g=50,b=new pv.Panel().canvas(document.getElementById("protovis")).width(c).height(i),h=pv.Scale.linear(0,dataSet.length-1).range(g,c-g*2),f=pv.Scale.linear(0,1).range(i-g,g);dataSet.sort(function(k,j){if(k.category>j.category){return 1}if(j.category>k.category){return -1}return k.googleHits-j.googleHits});var e=pv.Colors.category10().by(function(j){return j.category});var d=function(j){return Math.log(10*j+1)/Math.log(11)};var a=b.add(pv.Dot).data(dataSet).size(function(j){return 120*d(j.percent)}).top(function(j){return f(d(j.percent))}).left(function(j){return h(this.index)}).strokeStyle(e).lineWidth(0.5).fillStyle(e).title(function(j){return j.name||""}).cursor("pointer").event("click",function(j){window.open(j.url)});a.anchor("right").add(pv.Label).text(function(j){return j.name||""}).textAngle(Math.PI/6).textBaseline("bottom").textStyle(new pv.Color.Hsl(0.65,0.5,0.1,0.75)).font('11px "Helvetica"');a.anchor("right").add(pv.Label).text(function(j){return j.googleHits+" hits"||""}).textAngle(Math.PI/6).textBaseline("top").textStyle(new pv.Color.Hsl(0.65,0.5,0.1,0.33)).font('11px "Helvetica"');b.render()};